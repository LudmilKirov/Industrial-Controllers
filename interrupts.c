/******************************************************************************/
/* Files to Include                                                           */
/******************************************************************************/

/* Device header file */
#if defined(__XC16__)
    #include <xc.h>
#elif defined(__C30__)
    #if defined(__dsPIC33E__)
    	#include <p33Exxxx.h>
    #elif defined(__dsPIC33F__)
    	#include <p33Fxxxx.h>
    #endif
#endif

#include <stdint.h>        /* Includes uint16_t definition   */
#include <stdbool.h>       /* Includes true/false definition */
#define TPER 3300
/******************************************************************************/
/* Interrupt Vector Options                                                   */
/******************************************************************************/
/*                                                                            */
/* Refer to the C30 (MPLAB C Compiler for PIC24F MCUs and dsPIC33F DSCs) User */
/* Guide for an up to date list of the available interrupt options.           */
/* Alternately these names can be pulled from the device linker scripts.      */
/*                                                                            */
/* dsPIC33F Primary Interrupt Vector Names:                                   */
/*                                                                            */
/* _INT0Interrupt      _C1Interrupt                                           */
/* _IC1Interrupt       _DMA3Interrupt                                         */
/* _OC1Interrupt       _IC3Interrupt                                          */
/* _T1Interrupt        _IC4Interrupt                                          */
/* _DMA0Interrupt      _IC5Interrupt                                          */
/* _IC2Interrupt       _IC6Interrupt                                          */
/* _OC2Interrupt       _OC5Interrupt                                          */
/* _T2Interrupt        _OC6Interrupt                                          */
/* _T3Interrupt        _OC7Interrupt                                          */
/* _SPI1ErrInterrupt   _OC8Interrupt                                          */
/* _SPI1Interrupt      _DMA4Interrupt                                         */
/* _U1RXInterrupt      _T6Interrupt                                           */
/* _U1TXInterrupt      _T7Interrupt                                           */
/* _ADC1Interrupt      _SI2C2Interrupt                                        */
/* _DMA1Interrupt      _MI2C2Interrupt                                        */
/* _SI2C1Interrupt     _T8Interrupt                                           */
/* _MI2C1Interrupt     _T9Interrupt                                           */
/* _CNInterrupt        _INT3Interrupt                                         */
/* _INT1Interrupt      _INT4Interrupt                                         */
/* _ADC2Interrupt      _C2RxRdyInterrupt                                      */
/* _DMA2Interrupt      _C2Interrupt                                           */
/* _OC3Interrupt       _DCIErrInterrupt                                       */
/* _OC4Interrupt       _DCIInterrupt                                          */
/* _T4Interrupt        _DMA5Interrupt                                         */
/* _T5Interrupt        _U1ErrInterrupt                                        */
/* _INT2Interrupt      _U2ErrInterrupt                                        */
/* _U2RXInterrupt      _DMA6Interrupt                                         */
/* _U2TXInterrupt      _DMA7Interrupt                                         */
/* _SPI2ErrInterrupt   _C1TxReqInterrupt                                      */
/* _SPI2Interrupt      _C2TxReqInterrupt                                      */
/* _C1RxRdyInterrupt                                                          */
/*                                                                            */
/* dsPIC33E Primary Interrupt Vector Names:                                   */
/*                                                                            */
/* _INT0Interrupt     _IC4Interrupt      _U4TXInterrupt                       */
/* _IC1Interrupt      _IC5Interrupt      _SPI3ErrInterrupt                    */
/* _OC1Interrupt      _IC6Interrupt      _SPI3Interrupt                       */
/* _T1Interrupt       _OC5Interrupt      _OC9Interrupt                        */
/* _DMA0Interrupt     _OC6Interrupt      _IC9Interrupt                        */
/* _IC2Interrupt      _OC7Interrupt      _PWM1Interrupt                       */
/* _OC2Interrupt      _OC8Interrupt      _PWM2Interrupt                       */
/* _T2Interrupt       _PMPInterrupt      _PWM3Interrupt                       */
/* _T3Interrupt       _DMA4Interrupt     _PWM4Interrupt                       */
/* _SPI1ErrInterrupt  _T6Interrupt       _PWM5Interrupt                       */
/* _SPI1Interrupt     _T7Interrupt       _PWM6Interrupt                       */
/* _U1RXInterrupt     _SI2C2Interrupt    _PWM7Interrupt                       */
/* _U1TXInterrupt     _MI2C2Interrupt    _DMA8Interrupt                       */
/* _AD1Interrupt      _T8Interrupt       _DMA9Interrupt                       */
/* _DMA1Interrupt     _T9Interrupt       _DMA10Interrupt                      */
/* _NVMInterrupt      _INT3Interrupt     _DMA11Interrupt                      */
/* _SI2C1Interrupt    _INT4Interrupt     _SPI4ErrInterrupt                    */
/* _MI2C1Interrupt    _C2RxRdyInterrupt  _SPI4Interrupt                       */
/* _CM1Interrupt      _C2Interrupt       _OC10Interrupt                       */
/* _CNInterrupt       _QEI1Interrupt     _IC10Interrupt                       */
/* _INT1Interrupt     _DCIEInterrupt     _OC11Interrupt                       */
/* _AD2Interrupt      _DCIInterrupt      _IC11Interrupt                       */
/* _IC7Interrupt      _DMA5Interrupt     _OC12Interrupt                       */
/* _IC8Interrupt      _RTCCInterrupt     _IC12Interrupt                       */
/* _DMA2Interrupt     _U1ErrInterrupt    _DMA12Interrupt                      */
/* _OC3Interrupt      _U2ErrInterrupt    _DMA13Interrupt                      */
/* _OC4Interrupt      _CRCInterrupt      _DMA14Interrupt                      */
/* _T4Interrupt       _DMA6Interrupt     _OC13Interrupt                       */
/* _T5Interrupt       _DMA7Interrupt     _IC13Interrupt                       */
/* _INT2Interrupt     _C1TxReqInterrupt  _OC14Interrupt                       */
/* _U2RXInterrupt     _C2TxReqInterrupt  _IC14Interrupt                       */
/* _U2TXInterrupt     _QEI2Interrupt     _OC15Interrupt                       */
/* _SPI2ErrInterrupt  _U3ErrInterrupt    _IC15Interrupt                       */
/* _SPI2Interrupt     _U3RXInterrupt     _OC16Interrupt                       */
/* _C1RxRdyInterrupt  _U3TXInterrupt     _IC16Interrupt                       */
/* _C1Interrupt       _USB1Interrupt     _ICDInterrupt                        */
/* _DMA3Interrupt     _U4ErrInterrupt    _PWMSpEventMatchInterrupt            */
/* _IC3Interrupt      _U4RXInterrupt     _PWMSecSpEventMatchInterrupt         */
/*                                                                            */
/* For alternate interrupt vector naming, simply add 'Alt' between the prim.  */
/* interrupt vector name '_' and the first character of the primary interrupt */
/* vector name.  There is no Alternate Vector or 'AIVT' for the 33E family.   */
/*                                                                            */
/* For example, the vector name _ADC2Interrupt becomes _AltADC2Interrupt in   */
/* the alternate vector table.                                                */
/*                                                                            */
/* Example Syntax:                                                            */
/*                                                                            */
/* void __attribute__((interrupt,auto_psv)) <Vector Name>(void)               */
/* {                                                                          */
/*     <Clear Interrupt Flag>                                                 */
/* }                                                                          */
/*                                                                            */
/* For more comprehensive interrupt examples refer to the C30 (MPLAB C        */
/* Compiler for PIC24 MCUs and dsPIC DSCs) User Guide in the                  */
/* <C30 compiler instal directory>/doc directory for the latest compiler      */
/* release.  For XC16, refer to the MPLAB XC16 C Compiler User's Guide in the */
/* <XC16 compiler instal directory>/doc folder.                               */
/*                                                                            */
/******************************************************************************/
/* Interrupt Routines                                                         */
/******************************************************************************/

/* TODO Add interrupt routine code here. */
int i =0;
double array0[]={2000,
2031,
2063,
2094,
2126,
2157,
2188,
2219,
2251,
2282,
2313,
2344,
2375,
2406,
2436,
2467,
2497,
2528,
2558,
2588,
2618,
2648,
2677,
2707,
2736,
2765,
2794,
2823,
2852,
2880,
2908,
2936,
2964,
2991,
3018,
3045,
3072,
3098,
3124,
3150,
3176,
3201,
3226,
3250,
3275,
3299,
3323,
3346,
3369,
3392,
3414,
3436,
3458,
3479,
3500,
3521,
3541,
3561,
3580,
3599,
3618,
3636,
3654,
3672,
3689,
3705,
3721,
3737,
3753,
3768,
3782,
3796,
3810,
3823,
3836,
3848,
3860,
3871,
3882,
3892,
3902,
3912,
3921,
3929,
3937,
3945,
3952,
3958,
3965,
3970,
3975,
3980,
3984,
3988,
3991,
3994,
3996,
3998,
3999,
4000,
4000,
4000,
3999,
3998,
3996,
3994,
3991,
3988,
3984,
3980,
3975,
3970,
3965,
3958,
3952,
3945,
3937,
3929,
3921,
3912,
3902,
3892,
3882,
3871,
3860,
3848,
3836,
3823,
3810,
3796,
3782,
3768,
3753,
3737,
3721,
3705,
3689,
3672,
3654,
3636,
3618,
3599,
3580,
3561,
3541,
3521,
3500,
3479,
3458,
3436,
3414,
3392,
3369,
3346,
3323,
3299,
3275,
3250,
3226,
3201,
3176,
3150,
3124,
3098,
3072,
3045,
3018,
2991,
2964,
2936,
2908,
2880,
2852,
2823,
2794,
2765,
2736,
2707,
2677,
2648,
2618,
2588,
2558,
2528,
2497,
2467,
2436,
2406,
2375,
2344,
2313,
2282,
2251,
2219,
2188,
2157,
2126,
2094,
2063,
2031,
2000,
1969,
1937,
1906,
1874,
1843,
1812,
1781,
1749,
1718,
1687,
1656,
1625,
1594,
1564,
1533,
1503,
1472,
1442,
1412,
1382,
1352,
1323,
1293,
1264,
1235,
1206,
1177,
1148,
1120,
1092,
1064,
1036,
1009,
982,
955,
928,
902,
876,
850,
824,
799,
774,
750,
725,
701,
677,
654,
631,
608,
586,
564,
542,
521,
500,
479,
459,
439,
420,
401,
382,
364,
346,
328,
311,
295,
279,
263,
247,
232,
218,
204,
190,
177,
164,
152,
140,
129,
118,
108,
98,
88,
79,
71,
63,
55,
48,
42,
35,
30,
25,
20,
16,
12,
9,
6,
4,
2,
1,
0,
0,
0,
1,
2,
4,
6,
9,
12,
16,
20,
25,
30,
35,
42,
48,
55,
63,
71,
79,
88,
98,
108,
118,
129,
140,
152,
164,
177,
190,
204,
218,
232,
247,
263,
279,
295,
311,
328,
346,
364,
382,
401,
420,
439,
459,
479,
500,
521,
542,
564,
586,
608,
631,
654,
677,
701,
725,
750,
774,
799,
824,
850,
876,
902,
928,
955,
982,
1009,
1036,
1064,
1092,
1120,
1148,
1177,
1206,
1235,
1264,
1293,
1323,
1352,
1382,
1412,
1442,
1472,
1503,
1533,
1564,
1594,
1625,
1656,
1687,
1718,
1749,
1781,
1812,
1843,
1874,
1906,
1937,
1969};

double array120[]={3732,
3716,
3700,
3683,
3666,
3648,
3630,
3612,
3593,
3574,
3554,
3534,
3514,
3493,
3472,
3451,
3429,
3407,
3384,
3361,
3338,
3315,
3291,
3267,
3242,
3218,
3192,
3167,
3141,
3115,
3089,
3063,
3036,
3009,
2982,
2954,
2927,
2899,
2870,
2842,
2813,
2785,
2756,
2727,
2697,
2668,
2638,
2608,
2578,
2548,
2518,
2487,
2457,
2426,
2395,
2364,
2334,
2303,
2271,
2240,
2209,
2178,
2146,
2115,
2084,
2052,
2021,
1990,
1958,
1927,
1895,
1864,
1833,
1801,
1770,
1739,
1708,
1677,
1646,
1615,
1584,
1553,
1523,
1492,
1462,
1432,
1402,
1372,
1342,
1313,
1283,
1254,
1225,
1196,
1167,
1139,
1111,
1083,
1055,
1027,
1000,
973,
946,
920,
893,
867,
841,
816,
791,
766,
741,
717,
693,
670,
646,
623,
601,
578,
556,
535,
514,
493,
472,
452,
433,
413,
394,
376,
358,
340,
323,
306,
289,
273,
258,
242,
228,
213,
199,
186,
173,
160,
148,
137,
125,
115,
104,
95,
85,
77,
68,
60,
53,
46,
39,
33,
28,
23,
19,
14,
11,
8,
5,
3,
2,
1,
0,
0,
0,
1,
3,
5,
7,
10,
13,
17,
21,
26,
32,
37,
44,
50,
58,
65,
74,
82,
92,
101,
111,
122,
133,
144,
156,
169,
182,
195,
209,
223,
237,
252,
268,
284,
300,
317,
334,
352,
370,
388,
407,
426,
446,
466,
486,
507,
528,
549,
571,
593,
616,
639,
662,
685,
709,
733,
758,
782,
808,
833,
859,
885,
911,
937,
964,
991,
1018,
1046,
1073,
1101,
1130,
1158,
1187,
1215,
1244,
1273,
1303,
1332,
1362,
1392,
1422,
1452,
1482,
1513,
1543,
1574,
1605,
1636,
1666,
1697,
1729,
1760,
1791,
1822,
1854,
1885,
1916,
1948,
1979,
2010,
2042,
2073,
2105,
2136,
2167,
2199,
2230,
2261,
2292,
2323,
2354,
2385,
2416,
2447,
2477,
2508,
2538,
2568,
2598,
2628,
2658,
2687,
2717,
2746,
2775,
2804,
2833,
2861,
2889,
2917,
2945,
2973,
3000,
3027,
3054,
3080,
3107,
3133,
3159,
3184,
3209,
3234,
3259,
3283,
3307,
3330,
3354,
3377,
3399,
3422,
3444,
3465,
3486,
3507,
3528,
3548,
3567,
3587,
3606,
3624,
3642,
3660,
3677,
3694,
3711,
3727,
3742,
3758,
3772,
3787,
3801,
3814,
3827,
3840,
3852,
3863,
3875,
3885,
3896,
3905,
3915,
3923,
3932,
3940,
3947,
3954,
3961,
3967,
3972,
3977,
3981,
3986,
3989,
3992,
3995,
3997,
3998,
3999,
4000,
4000,
4000,
3999,
3997,
3995,
3993,
3990,
3987,
3983,
3979,
3974,
3968,
3963,
3956,
3950,
3942,
3935,
3926,
3918,
3908,
3899,
3889,
3878,
3867,
3856,
3844,
3831,
3818,
3805,
3791,
3777,
3763,
3748};
double array240[]{268,
252,
237,
223,
209,
195,
182,
169,
156,
144,
133,
122,
111,
101,
92,
82,
74,
65,
58,
50,
44,
37,
32,
26,
21,
17,
13,
10,
7,
5,
3,
1,
0,
0,
0,
1,
2,
3,
5,
8,
11,
14,
19,
23,
28,
33,
39,
46,
53,
60,
68,
77,
85,
95,
104,
115,
125,
137,
148,
160,
173,
186,
199,
213,
228,
242,
258,
273,
289,
306,
323,
340,
358,
376,
394,
413,
433,
452,
472,
493,
514,
535,
556,
578,
601,
623,
646,
670,
693,
717,
741,
766,
791,
816,
841,
867,
893,
920,
946,
973,
1000,
1027,
1055,
1083,
1111,
1139,
1167,
1196,
1225,
1254,
1283,
1313,
1342,
1372,
1402,
1432,
1462,
1492,
1523,
1553,
1584,
1615,
1646,
1677,
1708,
1739,
1770,
1801,
1833,
1864,
1895,
1927,
1958,
1990,
2021,
2052,
2084,
2115,
2146,
2178,
2209,
2240,
2271,
2303,
2334,
2364,
2395,
2426,
2457,
2487,
2518,
2548,
2578,
2608,
2638,
2668,
2697,
2727,
2756,
2785,
2813,
2842,
2870,
2899,
2927,
2954,
2982,
3009,
3036,
3063,
3089,
3115,
3141,
3167,
3192,
3218,
3242,
3267,
3291,
3315,
3338,
3361,
3384,
3407,
3429,
3451,
3472,
3493,
3514,
3534,
3554,
3574,
3593,
3612,
3630,
3648,
3666,
3683,
3700,
3716,
3732,
3748,
3763,
3777,
3791,
3805,
3818,
3831,
3844,
3856,
3867,
3878,
3889,
3899,
3908,
3918,
3926,
3935,
3942,
3950,
3956,
3963,
3968,
3974,
3979,
3983,
3987,
3990,
3993,
3995,
3997,
3999,
4000,
4000,
4000,
3999,
3998,
3997,
3995,
3992,
3989,
3986,
3981,
3977,
3972,
3967,
3961,
3954,
3947,
3940,
3932,
3923,
3915,
3905,
3896,
3885,
3875,
3863,
3852,
3840,
3827,
3814,
3801,
3787,
3772,
3758,
3742,
3727,
3711,
3694,
3677,
3660,
3642,
3624,
3606,
3587,
3567,
3548,
3528,
3507,
3486,
3465,
3444,
3422,
3399,
3377,
3354,
3330,
3307,
3283,
3259,
3234,
3209,
3184,
3159,
3133,
3107,
3080,
3054,
3027,
3000,
2973,
2945,
2917,
2889,
2861,
2833,
2804,
2775,
2746,
2717,
2687,
2658,
2628,
2598,
2568,
2538,
2508,
2477,
2447,
2416,
2385,
2354,
2323,
2292,
2261,
2230,
2199,
2167,
2136,
2105,
2073,
2042,
2010,
1979,
1948,
1916,
1885,
1854,
1822,
1791,
1760,
1729,
1697,
1666,
1636,
1605,
1574,
1543,
1513,
1482,
1452,
1422,
1392,
1362,
1332,
1303,
1273,
1244,
1215,
1187,
1158,
1130,
1101,
1073,
1046,
1018,
991,
964,
937,
911,
885,
859,
833,
808,
782,
758,
733,
709,
685,
662,
639,
616,
593,
571,
549,
528,
507,
486,
466,
446,
426,
407,
388,
370,
352,
334,
317,
300,
284};

void __attribute__((interrupt,auto_psv)) 	_MPWM1Interrupt(void)  {
 
   
    P1DC1=array0[i];
    P1DC2=array120[i];
    P1DC3=array240[i];
    i++;

        if(i==399)
        {
           i=0;  
        }
 
//    else
//    {
//    P1DC1=0;
//    P1DC2=0.66*TPER;
//    P1DC3=1.33*TPER;
//    }
    IFS3bits.PWM1IF=0;

}
void __attribute__((interrupt,auto_psv)) 	_ADC1Interrupt(void)               
 {      
    int i=0;
    int *P=&ADCBUF0;
    int x=0;
    
    
for(i;i<16;i++) {
   x+= *P++;
}
  //  PDC1=x/16;
    
    
     IFS0bits.AD1IF=0;  
    
 }          